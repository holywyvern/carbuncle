<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Carbuncle::Tilemap
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

  <link rel="stylesheet" href="../css/mruby.css" type="text/css" />

<script type="text/javascript">
  pathId = "Carbuncle::Tilemap";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/mruby.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (T)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Carbuncle.html" title="Carbuncle (module)">Carbuncle</a></span></span>
     &raquo; 
    <span class="title">Tilemap</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Carbuncle::Tilemap
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Carbuncle::Tilemap</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>gems/carbuncle-graphics/src/tilemap.c<span class="defines">,<br />
  gems/carbuncle-graphics/mrblib/tilemap.rb</span>
</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Tilemap/ImageLayer.html" title="Carbuncle::Tilemap::ImageLayer (class)">ImageLayer</a></span>, <span class='object_link'><a href="Tilemap/Layer.html" title="Carbuncle::Tilemap::Layer (class)">Layer</a></span>, <span class='object_link'><a href="Tilemap/LayerGroup.html" title="Carbuncle::Tilemap::LayerGroup (class)">LayerGroup</a></span>, <span class='object_link'><a href="Tilemap/ObjectLayer.html" title="Carbuncle::Tilemap::ObjectLayer (class)">ObjectLayer</a></span>, <span class='object_link'><a href="Tilemap/Tile.html" title="Carbuncle::Tilemap::Tile (class)">Tile</a></span>, <span class='object_link'><a href="Tilemap/TileLayer.html" title="Carbuncle::Tilemap::TileLayer (class)">TileLayer</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dispose-instance_method" title="#dispose (instance method)">#<strong>dispose</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#disposed%3F-instance_method" title="#disposed? (instance method)">#<strong>disposed?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#draw-instance_method" title="#draw (instance method)">#<strong>draw</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#height-instance_method" title="#height (instance method)">#<strong>height</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#layers-instance_method" title="#layers (instance method)">#<strong>layers</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#offset-instance_method" title="#offset (instance method)">#<strong>offset</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#offset=-instance_method" title="#offset= (instance method)">#<strong>offset=</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#properties-instance_method" title="#properties (instance method)">#<strong>properties</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#size-instance_method" title="#size (instance method)">#<strong>size</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tile_height-instance_method" title="#tile_height (instance method)">#<strong>tile_height</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tile_size-instance_method" title="#tile_size (instance method)">#<strong>tile_size</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tile_width-instance_method" title="#tile_width (instance method)">#<strong>tile_width</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tiles-instance_method" title="#tiles (instance method)">#<strong>tiles</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tiles_at-instance_method" title="#tiles_at (instance method)">#<strong>tiles_at</strong>(x, y)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update-instance_method" title="#update (instance method)">#<strong>update</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#width-instance_method" title="#width (instance method)">#<strong>width</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 396</span>

static mrb_value
mrb_tilemap_initialize(mrb_state *mrb, mrb_value self)
{
  int arena;
  const char *name;
  tmx_map *map;
  mrb_get_args(mrb, &quot;z&quot;, &amp;name);
  tilemap_current_mrb = mrb;
  map = tmx_load(name);
  if (!map)
  {
    mrb_raisef(mrb, E_ARGUMENT_ERROR, &quot;Failed to load map &#39;%s&#39; (%s)&quot;, name, tmx_strerr());
  }
  DATA_PTR(self) = map;
  DATA_TYPE(self) = &amp;tilemap_data_type;
  arena = mrb_gc_arena_save(mrb);
  mrb_value layers = mrb_ary_new(mrb);
  mrb_iv_set(mrb, self, LAYERS_SYMBOL, layers);
  mrb_iv_set(mrb, self, OFFSET_SYMBOL, mrb_carbuncle_point_new(mrb, 0, 0));
  setup_layers(mrb, map, self);
  setup_tiles(mrb, map, self);
  setup_properties(mrb, self, map-&gt;properties);
  mrb_gc_arena_restore(mrb, arena);
  return self;
}</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="dispose-instance_method">
  
    #<strong>dispose</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


478
479
480
481
482
483
484
485
486</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 478</span>

static mrb_value
mrb_tilemap_dispose(mrb_state *mrb, mrb_value self)
{
  mrb_carbuncle_get_tilemap(mrb, self);
  mrb_tilemap_free(mrb, DATA_PTR(self));
  DATA_PTR(self) = NULL;
  mrb_iv_set(mrb, self, LAYERS_SYMBOL, mrb_ary_new(mrb));
  return self;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="disposed?-instance_method">
  
    #<strong>disposed?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>

<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


472
473
474
475
476</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 472</span>

static mrb_value
mrb_tilemap_disposedQ(mrb_state *mrb, mrb_value self)
{
  return mrb_bool_value(!DATA_PTR(self));
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="draw-instance_method">
  
    #<strong>draw</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


522
523
524
525
526
527
528
529
530
531
532
533
534
535
536</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 522</span>

static mrb_value
mrb_tilemap_draw(mrb_state *mrb, mrb_value self)
{
  size_t len;
  mrb_value layers;
  tmx_map *map = mrb_carbuncle_get_tilemap(mrb, self);
  layers = mrb_iv_get(mrb, self, LAYERS_SYMBOL);
  len = RARRAY_LEN(layers);
  ClearBackground(GetColor(map-&gt;backgroundcolor));
  for (size_t i = 0; i &lt; len; ++i)
  {
    mrb_funcall(mrb, mrb_ary_entry(layers, i), &quot;draw&quot;, 0);
  }
  return self;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="height-instance_method">
  
    #<strong>height</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


441
442
443
444
445
446</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 441</span>

static mrb_value
mrb_tilemap_get_height(mrb_state *mrb, mrb_value self)
{
  tmx_map *map = mrb_carbuncle_get_tilemap(mrb, self);
  return mrb_fixnum_value(map-&gt;height);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layers-instance_method">
  
    #<strong>layers</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


422
423
424
425
426</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 422</span>

static mrb_value
mrb_tilemap_get_layers(mrb_state *mrb, mrb_value self)
{
  return mrb_iv_get(mrb, self, LAYERS_SYMBOL);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="offset-instance_method">
  
    #<strong>offset</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


428
429
430
431
432</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 428</span>

static mrb_value
mrb_tilemap_get_offset(mrb_state *mrb, mrb_value self)
{
  return mrb_iv_get(mrb, self, OFFSET_SYMBOL);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="offset=-instance_method">
  
    #<strong>offset=</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


462
463
464
465
466
467
468
469
470</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 462</span>

static mrb_value
mrb_tilemap_set_offset(mrb_state *mrb, mrb_value self)
{
  mrb_value value;
  mrb_get_args(mrb, &quot;o&quot;, &amp;value);
  mrb_carbuncle_get_point(mrb, value);
  mrb_iv_set(mrb, self, OFFSET_SYMBOL, value);
  return value;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="properties-instance_method">
  
    #<strong>properties</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


683
684
685
686
687</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 683</span>

static mrb_value
mrb_any_get_properties(mrb_state *mrb, mrb_value self)
{
  return mrb_iv_get(mrb, self, PROPERTIES_SYMBOL);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="size-instance_method">
  
    #<strong>size</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3
4
5</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/mrblib/tilemap.rb', line 3</span>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='ivar'>@size</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../Carbuncle.html" title="Carbuncle (module)">Carbuncle</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Point.html" title="Carbuncle::Point (class)">Point</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Point.html#initialize-instance_method" title="Carbuncle::Point#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_width'>width</span><span class='comma'>,</span> <span class='id identifier rubyid_height'>height</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tile_height-instance_method">
  
    #<strong>tile_height</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


455
456
457
458
459
460</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 455</span>

static mrb_value
mrb_tilemap_get_tile_height(mrb_state *mrb, mrb_value self)
{
  tmx_map *map = mrb_carbuncle_get_tilemap(mrb, self);
  return mrb_fixnum_value(map-&gt;tile_height);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tile_size-instance_method">
  
    #<strong>tile_size</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/mrblib/tilemap.rb', line 7</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tile_size'>tile_size</span>
  <span class='ivar'>@tile_size</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../Carbuncle.html" title="Carbuncle (module)">Carbuncle</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Point.html" title="Carbuncle::Point (class)">Point</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Point.html#initialize-instance_method" title="Carbuncle::Point#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_tile_width'>tile_width</span><span class='comma'>,</span> <span class='id identifier rubyid_tile_height'>tile_height</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tile_width-instance_method">
  
    #<strong>tile_width</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


448
449
450
451
452
453</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 448</span>

static mrb_value
mrb_tilemap_get_tile_width(mrb_state *mrb, mrb_value self)
{
  tmx_map *map = mrb_carbuncle_get_tilemap(mrb, self);
  return mrb_fixnum_value(map-&gt;tile_width);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tiles-instance_method">
  
    #<strong>tiles</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


689
690
691
692
693</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 689</span>

static mrb_value
mrb_tilemap_get_tiles(mrb_state *mrb, mrb_value self)
{
  return mrb_iv_get(mrb, self, TILES_SYMBOL);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tiles_at-instance_method">
  
    #<strong>tiles_at</strong>(x, y)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15
16</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/mrblib/tilemap.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tiles_at'>tiles_at</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_layers'>layers</span>
    <span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Carbuncle.html" title="Carbuncle (module)">Carbuncle</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Carbuncle::Tilemap (class)">Tilemap</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Tilemap/TileLayer.html" title="Carbuncle::Tilemap::TileLayer (class)">TileLayer</a></span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_tile_at'>tile_at</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:present?</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update-instance_method">
  
    #<strong>update</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 488</span>

static mrb_value
mrb_tilemap_update(mrb_state *mrb, mrb_value self)
{
  size_t len;
  mrb_value dtv, layers;
  mrb_float dt;
  tmx_map *map = mrb_carbuncle_get_tilemap(mrb, self);
  mrb_get_args(mrb, &quot;f&quot;, &amp;dt);
  dtv = mrb_float_value(mrb, dt);
  layers = mrb_iv_get(mrb, self, LAYERS_SYMBOL);
  len = RARRAY_LEN(layers);
  for (size_t i = 0; i &lt; map-&gt;tilecount; ++i)
  {
    tmx_tile *tile = map-&gt;tiles[i];
    if (tile &amp;&amp; tile-&gt;animation_len)
    {
      struct mrb_TileData *data = tile-&gt;user_data.pointer;
      tmx_anim_frame animation = tile-&gt;animation[data-&gt;frame];
      data-&gt;frame_time += dt * 1000;
      while (data-&gt;frame_time &gt;= animation.duration)
      {
        data-&gt;frame_time -= animation.duration;
        data-&gt;frame = (data-&gt;frame + 1) % tile-&gt;animation_len;
        animation = tile-&gt;animation[data-&gt;frame];
      }
    }
  }
  for (size_t i = 0; i &lt; len; ++i)
  {
    mrb_funcall(mrb, mrb_ary_entry(layers, i), &quot;update&quot;, 1, dtv);
  }
  return self;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="width-instance_method">
  
    #<strong>width</strong>  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


434
435
436
437
438
439</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'gems/carbuncle-graphics/src/tilemap.c', line 434</span>

static mrb_value
mrb_tilemap_get_width(mrb_state *mrb, mrb_value self)
{
  tmx_map *map = mrb_carbuncle_get_tilemap(mrb, self);
  return mrb_fixnum_value(map-&gt;width);
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jan 28 17:33:29 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 in <a href="https://github.com/sagmor/yard-mruby">mruby mode</a> 0.3.0 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>